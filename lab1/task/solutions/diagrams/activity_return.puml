@startuml
' Диаграмма деятельности: процесс возврата оборудования
start

:Прибытие клиента\nс оборудованием;

:Проверка данных аренды;

if (Аренда найдена?) then (да)
  :Проверка сроков\nвозврата;

  :Осмотр оборудования;

  :Оценка состояния;

  if (Есть повреждения?) then (нет)
    ' Отличное состояние
    :Возврат полного залога;

    :Оформление квитанции;

    :Обновление статуса\nна "Доступно";

    stop

  else (да)
    ' Есть повреждения
    if (Серьезные повреждения?) then (нет)
      ' Незначительные повреждения
      :Расчет стоимости\nремонта;

      :Вычет из залога;

      :Возврат остатка;

      :Планирование ремонта;

      stop

    else (да)
      ' Серьезные повреждения
      :Удержание залога;

      :Расчет стоимости\nзамены;

      if (Требуется доплата?) then (да)
        :Запрос доплаты;

        if (Клиент оплатил?) then (да)
          :Закрытие аренды;
          stop
        else (нет)
          :Процедура взыскания;
          stop
        endif
      else (нет)
        :Закрытие аренды;
        stop
      endif
    endif
  endif
else (нет)
  :Ошибка: аренда\nне найдена;
  stop
endif

@enduml
